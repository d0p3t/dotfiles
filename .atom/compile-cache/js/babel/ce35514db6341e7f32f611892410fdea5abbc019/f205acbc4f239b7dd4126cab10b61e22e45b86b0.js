function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

var _path = require('path');

// eslint-disable-next-line import/no-extraneous-dependencies

var _jasmineFix = require('jasmine-fix');

// NOTE: If using fit you must add it to the list above!

'use babel';

var fixturePath = (0, _path.join)(__dirname, 'fixtures');
var goodPath = (0, _path.join)(fixturePath, 'good.py');
var badPath = (0, _path.join)(fixturePath, 'bad.py');
var errwarnPath = (0, _path.join)(fixturePath, 'errwarn.py');
var builtinsPath = (0, _path.join)(fixturePath, 'builtins.py');

describe('The flake8 provider for Linter', function () {
  var lint = require('../lib/main.js').provideLinter().lint;

  (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
    // Info about this beforeEach() implementation:
    // https://github.com/AtomLinter/Meta/issues/15
    var activationPromise = atom.packages.activatePackage('linter-flake8');

    yield atom.packages.activatePackage('language-python');
    yield atom.workspace.open(goodPath);

    atom.packages.triggerDeferredActivationHooks();
    yield activationPromise;
  }));

  (0, _jasmineFix.it)('should be in the packages list', function () {
    return expect(atom.packages.isPackageLoaded('linter-flake8')).toBe(true);
  });

  (0, _jasmineFix.it)('should be an active package', function () {
    return expect(atom.packages.isPackageActive('linter-flake8')).toBe(true);
  });

  describe('checks bad.py and', function () {
    var editor = null;
    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      editor = yield atom.workspace.open(badPath);
    }));

    (0, _jasmineFix.it)('finds at least one message', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages.length).toBeGreaterThan(0);
    }));

    (0, _jasmineFix.it)('verifies that message', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Warning');
      expect(messages[0].html).not.toBeDefined();
      expect(messages[0].text).toBe('F821 — undefined name \'asfd\'');
      expect(messages[0].filePath).toBe(badPath);
      expect(messages[0].range).toEqual([[0, 0], [0, 4]]);
    }));

    (0, _jasmineFix.it)('checks that the message is an error if flakeErrors is set', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.flakeErrors', true);
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Error');
    }));
  });

  describe('checks errwarn.py and', function () {
    var editor = null;

    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      editor = yield atom.workspace.open(errwarnPath);
    }));

    (0, _jasmineFix.it)('finds at least one message', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages.length).toBeGreaterThan(0);
    }));

    (0, _jasmineFix.it)('finds the message is a warning if pycodestyleErrorsToWarnings is set', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.pycodestyleErrorsToWarnings', true);
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Warning');
    }));

    (0, _jasmineFix.it)("finds the message is an error if pycodestyleErrorsToWarnings isn't set", _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.pycodestyleErrorsToWarnings', false);
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Error');
    }));
  });

  (0, _jasmineFix.it)('finds nothing wrong with a valid file', _asyncToGenerator(function* () {
    var editor = yield atom.workspace.open(goodPath);
    var messages = yield lint(editor);
    expect(messages.length).toBe(0);
  }));

  describe('executable path', function () {
    var helpers = require('atom-linter');

    var editor = null;
    var realExec = helpers.exec;
    var execParams = [];
    function fakeExec() {
      for (var _len = arguments.length, parameters = Array(_len), _key = 0; _key < _len; _key++) {
        parameters[_key] = arguments[_key];
      }

      execParams.push(parameters);
      return Promise.resolve('');
    }

    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      atom.project.addPath(fixturePath);

      Object.defineProperty(helpers, 'exec', {
        enumerable: true,
        value: fakeExec
      });

      editor = yield atom.workspace.open(badPath);
    }));

    afterEach(function () {
      Object.defineProperty(helpers, 'exec', {
        enumerable: true,
        value: realExec
      });
    });

    (0, _jasmineFix.it)('finds executable relative to project', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.executablePath', (0, _path.join)('$PROJECT', 'flake8'));
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8'));
    }));

    (0, _jasmineFix.it)('finds executable relative to projects', _asyncToGenerator(function* () {
      var paths = [(0, _path.join)('$project', 'null'), (0, _path.join)('$pRoJeCt', 'flake1'), (0, _path.join)('$PrOjEcT', 'flake2'), (0, _path.join)('$PROJECT', 'flake8')].join(';');
      atom.config.set('linter-flake8.executablePath', paths);
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8'));
    }));

    (0, _jasmineFix.it)('finds executable using project name', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.executablePath', (0, _path.join)('$PROJECT_NAME', 'flake8'));
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)('fixtures', 'flake8'));
    }));

    (0, _jasmineFix.it)('finds executable using project names', _asyncToGenerator(function* () {
      var paths = [(0, _path.join)('$project_name', 'null'), (0, _path.join)('$pRoJeCt_NaMe', 'flake1'), (0, _path.join)('$PrOjEcT_nAmE', 'flake2'), (0, _path.join)('$PROJECT_NAME', 'flake8')].join(';');
      var correct = [(0, _path.join)('fixtures', 'null'), (0, _path.join)('fixtures', 'flake1'), (0, _path.join)('fixtures', 'flake2'), (0, _path.join)('fixtures', 'flake8')].join(';');
      atom.config.set('linter-flake8.executablePath', paths);
      yield lint(editor);
      expect(execParams.pop()[0]).toBe(correct);
    }));

    (0, _jasmineFix.it)('normalizes executable path', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.executablePath', (0, _path.join)(fixturePath, '..', 'fixtures', 'flake8'));
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8'));
    }));

    (0, _jasmineFix.it)('finds backup executable', _asyncToGenerator(function* () {
      var flakeNotFound = (0, _path.join)('$PROJECT', 'flake8_notfound');
      var flakeBackup = (0, _path.join)(fixturePath, 'flake8_backup');
      atom.config.set('linter-flake8.executablePath', flakeNotFound + ';' + flakeBackup);
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8_backup'));
    }));
  });

  describe('works with defining builtins', function () {
    var editor = undefined;

    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      editor = yield atom.workspace.open(builtinsPath);
    }));

    (0, _jasmineFix.it)('shows all warnings when the setting is blank', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages.length).toBe(2);

      expect(messages[0].type).toBe('Warning');
      expect(messages[0].html).not.toBeDefined();
      expect(messages[0].text).toBe('F821 — undefined name \'bar\'');
      expect(messages[0].filePath).toBe(builtinsPath);
      expect(messages[0].range).toEqual([[0, 6], [0, 9]]);

      expect(messages[1].type).toBe('Warning');
      expect(messages[1].html).not.toBeDefined();
      expect(messages[1].text).toBe('F821 — undefined name \'foo_bar\'');
      expect(messages[1].filePath).toBe(builtinsPath);
      expect(messages[1].range).toEqual([[1, 9], [1, 16]]);
    }));

    (0, _jasmineFix.it)('works with a single builtin', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.builtins', ['bar']);
      var messages = yield lint(editor);
      expect(messages.length).toBe(1);

      expect(messages[0].type).toBe('Warning');
      expect(messages[0].html).not.toBeDefined();
      expect(messages[0].text).toBe('F821 — undefined name \'foo_bar\'');
      expect(messages[0].filePath).toBe(builtinsPath);
      expect(messages[0].range).toEqual([[1, 9], [1, 16]]);
    }));

    (0, _jasmineFix.it)('works with multiple builtins', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.builtins', ['bar', 'foo_bar']);
      var messages = yield lint(editor);
      expect(messages.length).toBe(0);
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3JlbWNvLy5hdG9tL3BhY2thZ2VzL2xpbnRlci1mbGFrZTgvc3BlYy9saW50ZXItZmxha2U4LXNwZWMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7b0JBRXFCLE1BQU07Ozs7MEJBRUksYUFBYTs7OztBQUo1QyxXQUFXLENBQUM7O0FBT1osSUFBTSxXQUFXLEdBQUcsZ0JBQUssU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ2hELElBQU0sUUFBUSxHQUFHLGdCQUFLLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztBQUM5QyxJQUFNLE9BQU8sR0FBRyxnQkFBSyxXQUFXLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDNUMsSUFBTSxXQUFXLEdBQUcsZ0JBQUssV0FBVyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQ3BELElBQU0sWUFBWSxHQUFHLGdCQUFLLFdBQVcsRUFBRSxhQUFhLENBQUMsQ0FBQzs7QUFFdEQsUUFBUSxDQUFDLGdDQUFnQyxFQUFFLFlBQU07QUFDL0MsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUMsYUFBYSxFQUFFLENBQUMsSUFBSSxDQUFDOztBQUU1RCxnREFBVyxhQUFZOzs7QUFHckIsUUFBTSxpQkFBaUIsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsQ0FBQzs7QUFFekUsVUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3ZELFVBQU0sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7O0FBRXBDLFFBQUksQ0FBQyxRQUFRLENBQUMsOEJBQThCLEVBQUUsQ0FBQztBQUMvQyxVQUFNLGlCQUFpQixDQUFDO0dBQ3pCLEVBQUMsQ0FBQzs7QUFFSCxzQkFBRyxnQ0FBZ0MsRUFBRTtXQUNuQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLENB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QUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3RELEVBQUMsQ0FBQzs7QUFFSCx3QkFBRyw4QkFBOEIsb0JBQUUsYUFBWTtBQUM3QyxVQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDO0FBQzlELFVBQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3BDLFlBQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ2pDLEVBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiIvaG9tZS9yZW1jby8uYXRvbS9wYWNrYWdlcy9saW50ZXItZmxha2U4L3NwZWMvbGludGVyLWZsYWtlOC1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG5cbmltcG9ydCB7IGpvaW4gfSBmcm9tICdwYXRoJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tZXh0cmFuZW91cy1kZXBlbmRlbmNpZXNcbmltcG9ydCB7IGJlZm9yZUVhY2gsIGl0IH0gZnJvbSAnamFzbWluZS1maXgnO1xuLy8gTk9URTogSWYgdXNpbmcgZml0IHlvdSBtdXN0IGFkZCBpdCB0byB0aGUgbGlzdCBhYm92ZSFcblxuY29uc3QgZml4dHVyZVBhdGggPSBqb2luKF9fZGlybmFtZSwgJ2ZpeHR1cmVzJyk7XG5jb25zdCBnb29kUGF0aCA9IGpvaW4oZml4dHVyZVBhdGgsICdnb29kLnB5Jyk7XG5jb25zdCBiYWRQYXRoID0gam9pbihmaXh0dXJlUGF0aCwgJ2JhZC5weScpO1xuY29uc3QgZXJyd2FyblBhdGggPSBqb2luKGZpeHR1cmVQYXRoLCAnZXJyd2Fybi5weScpO1xuY29uc3QgYnVpbHRpbnNQYXRoID0gam9pbihmaXh0dXJlUGF0aCwgJ2J1aWx0aW5zLnB5Jyk7XG5cbmRlc2NyaWJlKCdUaGUgZmxha2U4IHByb3ZpZGVyIGZvciBMaW50ZXInLCAoKSA9PiB7XG4gIGNvbnN0IGxpbnQgPSByZXF1aXJlKCcuLi9saWIvbWFpbi5qcycpLnByb3ZpZGVMaW50ZXIoKS5saW50O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIEluZm8gYWJvdXQgdGhpcyBiZWZvcmVFYWNoKCkgaW1wbGVtZW50YXRpb246XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0F0b21MaW50ZXIvTWV0YS9pc3N1ZXMvMTVcbiAgICBjb25zdCBhY3RpdmF0aW9uUHJvbWlzZSA9IGF0b20ucGFja2FnZXMuYWN0aXZhdGVQYWNrYWdlKCdsaW50ZXItZmxha2U4Jyk7XG5cbiAgICBhd2FpdCBhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZSgnbGFuZ3VhZ2UtcHl0aG9uJyk7XG4gICAgYXdhaXQgYXRvbS53b3Jrc3BhY2Uub3Blbihnb29kUGF0aCk7XG5cbiAgICBhdG9tLnBhY2thZ2VzLnRyaWdnZXJEZWZlcnJlZEFjdGl2YXRpb25Ib29rcygpO1xuICAgIGF3YWl0IGFjdGl2YXRpb25Qcm9taXNlO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGluIHRoZSBwYWNrYWdlcyBsaXN0JywgKCkgPT5cbiAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5pc1BhY2thZ2VMb2FkZWQoJ2xpbnRlci1mbGFrZTgnKSkudG9CZSh0cnVlKSxcbiAgKTtcblxuICBpdCgnc2hvdWxkIGJlIGFuIGFjdGl2ZSBwYWNrYWdlJywgKCkgPT5cbiAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5pc1BhY2thZ2VBY3RpdmUoJ2xpbnRlci1mbGFrZTgnKSkudG9CZSh0cnVlKSxcbiAgKTtcblxuICBkZXNjcmliZSgnY2hlY2tzIGJhZC5weSBhbmQnLCAoKSA9PiB7XG4gICAgbGV0IGVkaXRvciA9IG51bGw7XG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICBlZGl0b3IgPSBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKGJhZFBhdGgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGF0IGxlYXN0IG9uZSBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgndmVyaWZpZXMgdGhhdCBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0udHlwZSkudG9CZSgnV2FybmluZycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLmh0bWwpLm5vdC50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnRleHQpLnRvQmUoJ0Y4MjEg4oCUIHVuZGVmaW5lZCBuYW1lIFxcJ2FzZmRcXCcnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5maWxlUGF0aCkudG9CZShiYWRQYXRoKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5yYW5nZSkudG9FcXVhbChbWzAsIDBdLCBbMCwgNF1dKTtcbiAgICB9KTtcblxuICAgIGl0KCdjaGVja3MgdGhhdCB0aGUgbWVzc2FnZSBpcyBhbiBlcnJvciBpZiBmbGFrZUVycm9ycyBpcyBzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZmxha2VFcnJvcnMnLCB0cnVlKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ0Vycm9yJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjaGVja3MgZXJyd2Fybi5weSBhbmQnLCAoKSA9PiB7XG4gICAgbGV0IGVkaXRvciA9IG51bGw7XG5cbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oZXJyd2FyblBhdGgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGF0IGxlYXN0IG9uZSBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgdGhlIG1lc3NhZ2UgaXMgYSB3YXJuaW5nIGlmIHB5Y29kZXN0eWxlRXJyb3JzVG9XYXJuaW5ncyBpcyBzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTgucHljb2Rlc3R5bGVFcnJvcnNUb1dhcm5pbmdzJywgdHJ1ZSk7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS50eXBlKS50b0JlKCdXYXJuaW5nJyk7XG4gICAgfSk7XG5cbiAgICBpdChcImZpbmRzIHRoZSBtZXNzYWdlIGlzIGFuIGVycm9yIGlmIHB5Y29kZXN0eWxlRXJyb3JzVG9XYXJuaW5ncyBpc24ndCBzZXRcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LnB5Y29kZXN0eWxlRXJyb3JzVG9XYXJuaW5ncycsIGZhbHNlKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ0Vycm9yJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdmaW5kcyBub3RoaW5nIHdyb25nIHdpdGggYSB2YWxpZCBmaWxlJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oZ29vZFBhdGgpO1xuICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgIGV4cGVjdChtZXNzYWdlcy5sZW5ndGgpLnRvQmUoMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdleGVjdXRhYmxlIHBhdGgnLCAoKSA9PiB7XG4gICAgY29uc3QgaGVscGVycyA9IHJlcXVpcmUoJ2F0b20tbGludGVyJyk7XG5cbiAgICBsZXQgZWRpdG9yID0gbnVsbDtcbiAgICBjb25zdCByZWFsRXhlYyA9IGhlbHBlcnMuZXhlYztcbiAgICBjb25zdCBleGVjUGFyYW1zID0gW107XG4gICAgZnVuY3Rpb24gZmFrZUV4ZWMoLi4ucGFyYW1ldGVycykge1xuICAgICAgZXhlY1BhcmFtcy5wdXNoKHBhcmFtZXRlcnMpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgnJyk7XG4gICAgfVxuXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLnByb2plY3QuYWRkUGF0aChmaXh0dXJlUGF0aCk7XG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShoZWxwZXJzLCAnZXhlYycsIHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IGZha2VFeGVjLFxuICAgICAgfSk7XG5cbiAgICAgIGVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oYmFkUGF0aCk7XG4gICAgfSk7XG5cbiAgICBhZnRlckVhY2goKCkgPT4ge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGhlbHBlcnMsICdleGVjJywge1xuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogcmVhbEV4ZWMsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdmaW5kcyBleGVjdXRhYmxlIHJlbGF0aXZlIHRvIHByb2plY3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLCBqb2luKCckUFJPSkVDVCcsICdmbGFrZTgnKSk7XG4gICAgICBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QoZXhlY1BhcmFtcy5wb3AoKVswXSkudG9CZShqb2luKGZpeHR1cmVQYXRoLCAnZmxha2U4JykpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGV4ZWN1dGFibGUgcmVsYXRpdmUgdG8gcHJvamVjdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXRocyA9IFtcbiAgICAgICAgam9pbignJHByb2plY3QnLCAnbnVsbCcpLFxuICAgICAgICBqb2luKCckcFJvSmVDdCcsICdmbGFrZTEnKSxcbiAgICAgICAgam9pbignJFByT2pFY1QnLCAnZmxha2UyJyksXG4gICAgICAgIGpvaW4oJyRQUk9KRUNUJywgJ2ZsYWtlOCcpLFxuICAgICAgXS5qb2luKCc7Jyk7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLCBwYXRocyk7XG4gICAgICBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QoZXhlY1BhcmFtcy5wb3AoKVswXSkudG9CZShqb2luKGZpeHR1cmVQYXRoLCAnZmxha2U4JykpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGV4ZWN1dGFibGUgdXNpbmcgcHJvamVjdCBuYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmV4ZWN1dGFibGVQYXRoJywgam9pbignJFBST0pFQ1RfTkFNRScsICdmbGFrZTgnKSk7XG4gICAgICBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QoZXhlY1BhcmFtcy5wb3AoKVswXSkudG9CZShqb2luKCdmaXh0dXJlcycsICdmbGFrZTgnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgZXhlY3V0YWJsZSB1c2luZyBwcm9qZWN0IG5hbWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGF0aHMgPSBbXG4gICAgICAgIGpvaW4oJyRwcm9qZWN0X25hbWUnLCAnbnVsbCcpLFxuICAgICAgICBqb2luKCckcFJvSmVDdF9OYU1lJywgJ2ZsYWtlMScpLFxuICAgICAgICBqb2luKCckUHJPakVjVF9uQW1FJywgJ2ZsYWtlMicpLFxuICAgICAgICBqb2luKCckUFJPSkVDVF9OQU1FJywgJ2ZsYWtlOCcpLFxuICAgICAgXS5qb2luKCc7Jyk7XG4gICAgICBjb25zdCBjb3JyZWN0ID0gW1xuICAgICAgICBqb2luKCdmaXh0dXJlcycsICdudWxsJyksXG4gICAgICAgIGpvaW4oJ2ZpeHR1cmVzJywgJ2ZsYWtlMScpLFxuICAgICAgICBqb2luKCdmaXh0dXJlcycsICdmbGFrZTInKSxcbiAgICAgICAgam9pbignZml4dHVyZXMnLCAnZmxha2U4JyksXG4gICAgICBdLmpvaW4oJzsnKTtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5leGVjdXRhYmxlUGF0aCcsIHBhdGhzKTtcbiAgICAgIGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChleGVjUGFyYW1zLnBvcCgpWzBdKS50b0JlKGNvcnJlY3QpO1xuICAgIH0pO1xuXG4gICAgaXQoJ25vcm1hbGl6ZXMgZXhlY3V0YWJsZSBwYXRoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmV4ZWN1dGFibGVQYXRoJyxcbiAgICAgICAgam9pbihmaXh0dXJlUGF0aCwgJy4uJywgJ2ZpeHR1cmVzJywgJ2ZsYWtlOCcpLFxuICAgICAgKTtcbiAgICAgIGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChleGVjUGFyYW1zLnBvcCgpWzBdKS50b0JlKGpvaW4oZml4dHVyZVBhdGgsICdmbGFrZTgnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgYmFja3VwIGV4ZWN1dGFibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmbGFrZU5vdEZvdW5kID0gam9pbignJFBST0pFQ1QnLCAnZmxha2U4X25vdGZvdW5kJyk7XG4gICAgICBjb25zdCBmbGFrZUJhY2t1cCA9IGpvaW4oZml4dHVyZVBhdGgsICdmbGFrZThfYmFja3VwJyk7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLFxuICAgICAgICBgJHtmbGFrZU5vdEZvdW5kfTske2ZsYWtlQmFja3VwfWAsXG4gICAgICApO1xuICAgICAgYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUoam9pbihmaXh0dXJlUGF0aCwgJ2ZsYWtlOF9iYWNrdXAnKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd3b3JrcyB3aXRoIGRlZmluaW5nIGJ1aWx0aW5zJywgKCkgPT4ge1xuICAgIGxldCBlZGl0b3I7XG5cbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oYnVpbHRpbnNQYXRoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG93cyBhbGwgd2FybmluZ3Mgd2hlbiB0aGUgc2V0dGluZyBpcyBibGFuaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzLmxlbmd0aCkudG9CZSgyKTtcblxuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ1dhcm5pbmcnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5odG1sKS5ub3QudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS50ZXh0KS50b0JlKCdGODIxIOKAlCB1bmRlZmluZWQgbmFtZSBcXCdiYXJcXCcnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5maWxlUGF0aCkudG9CZShidWlsdGluc1BhdGgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnJhbmdlKS50b0VxdWFsKFtbMCwgNl0sIFswLCA5XV0pO1xuXG4gICAgICBleHBlY3QobWVzc2FnZXNbMV0udHlwZSkudG9CZSgnV2FybmluZycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzFdLmh0bWwpLm5vdC50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzFdLnRleHQpLnRvQmUoJ0Y4MjEg4oCUIHVuZGVmaW5lZCBuYW1lIFxcJ2Zvb19iYXJcXCcnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1sxXS5maWxlUGF0aCkudG9CZShidWlsdGluc1BhdGgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzFdLnJhbmdlKS50b0VxdWFsKFtbMSwgOV0sIFsxLCAxNl1dKTtcbiAgICB9KTtcblxuICAgIGl0KCd3b3JrcyB3aXRoIGEgc2luZ2xlIGJ1aWx0aW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguYnVpbHRpbnMnLCBbJ2JhciddKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzLmxlbmd0aCkudG9CZSgxKTtcblxuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ1dhcm5pbmcnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5odG1sKS5ub3QudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS50ZXh0KS50b0JlKCdGODIxIOKAlCB1bmRlZmluZWQgbmFtZSBcXCdmb29fYmFyXFwnJyk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0uZmlsZVBhdGgpLnRvQmUoYnVpbHRpbnNQYXRoKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5yYW5nZSkudG9FcXVhbChbWzEsIDldLCBbMSwgMTZdXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnd29ya3Mgd2l0aCBtdWx0aXBsZSBidWlsdGlucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5idWlsdGlucycsIFsnYmFyJywgJ2Zvb19iYXInXSk7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlcy5sZW5ndGgpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=